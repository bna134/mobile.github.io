window.__require=function e(t,n,o){function r(c,a){if(!n[c]){if(!t[c]){var s=c.split("/");if(s=s[s.length-1],!t[s]){var l="function"==typeof __require&&__require;if(!a&&l)return l(s,!0);if(i)return i(s,!0);throw new Error("Cannot find module '"+c+"'")}c=s}var h=n[c]={exports:{}};t[c][0].call(h.exports,function(e){return r(t[c][1][e]||e)},h,h.exports,e,t,n,o)}return n[c].exports}for(var i="function"==typeof __require&&__require,c=0;c<o.length;c++)r(o[c]);return r}({Boosters:[function(e,t,n){"use strict";cc._RF.push(t,"a11b8++IQtA34F52dAD6jZU","Boosters");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,c=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(c=(i<3?r(c):i>3?r(t,n,c):r(t,n))||c);return i>3&&c&&Object.defineProperty(t,n,c),c};Object.defineProperty(n,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=c.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bombCount=0,t.mashCount=0,t}return r(t,e),t.prototype.onLoad=function(){this.bombCount=+this.node.getChildByName("BombsContainer").getChildByName("BombCountContainer").getChildByName("BombCount").getComponent(cc.Label).string,this.mashCount=+this.node.getChildByName("MashContainer").getChildByName("MashCountContainer").getChildByName("MashCount").getComponent(cc.Label).string},t.prototype.start=function(){var e=this;this.node.getChildByName("BombsContainer").on(cc.Node.EventType.MOUSE_DOWN,this.clickBomb,this),this.node.getChildByName("MashContainer").on(cc.Node.EventType.MOUSE_DOWN,this.clickMash,this),cc.game.on("lockOrUnlockBomb",function(t){t?e.node.getChildByName("BombsContainer").off(cc.Node.EventType.MOUSE_DOWN,e.clickBomb,e):e.node.getChildByName("BombsContainer").on(cc.Node.EventType.MOUSE_DOWN,e.clickBomb,e)}),cc.game.on("decrementBombs",function(t){e.bombCount>0&&(e.bombCount-=t,e.decrementBomb())}),cc.game.on("decrementMash",function(t){e.mashCount>0&&(e.mashCount-=t,e.decrementMash())})},t.prototype.clickBomb=function(){this.bombCount>0&&cc.game.emit("clickBomb",!0)},t.prototype.clickMash=function(){this.mashCount>0&&cc.game.emit("clickMash")},t.prototype.decrementBomb=function(){this.node.getChildByName("BombsContainer").getChildByName("BombCountContainer").getChildByName("BombCount").getComponent(cc.Label).string=""+this.bombCount},t.prototype.decrementMash=function(){this.node.getChildByName("MashContainer").getChildByName("MashCountContainer").getChildByName("MashCount").getComponent(cc.Label).string=""+this.mashCount},i([s()],t.prototype,"bombCount",void 0),i([s()],t.prototype,"mashCount",void 0),i([a],t)}(cc.Component);n.default=l,cc._RF.pop()},{}],Score:[function(e,t,n){"use strict";cc._RF.push(t,"4b804KX4/NLNahsl5nxusKB","Score");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,c=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(c=(i<3?r(c):i>3?r(t,n,c):r(t,n))||c);return i>3&&c&&Object.defineProperty(t,n,c),c};Object.defineProperty(n,"__esModule",{value:!0});var c,a=cc._decorator,s=a.ccclass,l=a.property;(function(e){e.win="win",e.lose="lose"})(c||(c={}));var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.onLoad=function(){var e=this.node.getChildByName("Score").getComponent(cc.Label).string.slice(6).split("/");this.currentScore=+e[0],this.neccessaryScore=+e[1],this.turns=+this.node.getChildByName("TurnCountContainer").getChildByName("TurnCount").getComponent(cc.Label).string},t.prototype.start=function(){var e=this;cc.game.on("incrementScore",function(t){e.currentScore+=t,e.addScore()}),cc.game.on("decrementTurns",function(t){e.turns>0&&(e.turns-=t,e.decrementTurn())}),cc.game.on("CallLose",function(){e.getGameResult(c.lose)})},t.prototype.addScore=function(){this.turns>0&&this.currentScore>=this.neccessaryScore&&this.getGameResult(c.win),0===this.turns&&this.currentScore<this.neccessaryScore&&this.getGameResult(c.lose);var e=+this.node.getChildByName("Score").getComponent(cc.Label).string.slice(6).split("/")[0];this.node.getChildByName("Score").getComponent(cc.Label).string=this.node.getChildByName("Score").getComponent(cc.Label).string.replace(e+"/",this.currentScore+"/")},t.prototype.getGameResult=function(e){var t,n=this.node.getParent(),o=n.getParent();n.opacity=50,n.getChildByName("GameField").active=!1,t=e===c.win?"Win!!! Reload page to try again":"Lose!!! Reload page to try again",o.getChildByName("Result").getComponent(cc.Label).string=t},t.prototype.decrementTurn=function(){this.node.getChildByName("TurnCountContainer").getChildByName("TurnCount").getComponent(cc.Label).string=""+this.turns},i([l],t.prototype,"currentScore",void 0),i([l],t.prototype,"neccessaryScore",void 0),i([l()],t.prototype,"turns",void 0),i([s],t)}(cc.Component);n.default=h,cc._RF.pop()},{}],Tails:[function(e,t,n){"use strict";cc._RF.push(t,"4570eB3FetKVI9xVARIs7Ty","Tails");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,c=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(c=(i<3?r(c):i>3?r(t,n,c):r(t,n))||c);return i>3&&c&&Object.defineProperty(t,n,c),c},c=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var o=Array(e),r=0;for(t=0;t<n;t++)for(var i=arguments[t],c=0,a=i.length;c<a;c++,r++)o[r]=i[c];return o};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,l=a.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tailSpriteFrames=[],t.abilitiesTailSpriteFrames=[],t.isBombClicked=!1,t.invalidFieldMashes=3,t.canClick=!0,t.clickThrottle=.3,t}return r(t,e),t.prototype.onLoad=function(){for(var e=this,t=["block_purpure","block_blue","block_red","block_yellow","block_green"],n=function(t){cc.resources.load(t,cc.SpriteFrame,function(n,o){"bomb"===t?e.abilitiesTailSpriteFrames.push(o):e.tailSpriteFrames.push(o)})},o=0,r=c(t,["bomb"]);o<r.length;o++)n(r[o]);for(var i=0;i<5;i++){for(var a=function(e){var n=new cc.Node(""+i+e);s.node.addChild(n);var o=n.addComponent(cc.Sprite);n.setAnchorPoint(0,0),n.setPosition(new cc.Vec3(58*i,58*e));var r=t[Math.floor(5*Math.random())];cc.resources.load(r,cc.SpriteFrame,function(e,t){o.spriteFrame=t})},s=this,l=0;l<5;l++)a(l);for(var h=0,u=this.node.children;h<u.length;h++){var p=u[h];cc.instantiate(p)}}},t.prototype.start=function(){for(var e=this,t=0,n=this.node.children;t<n.length;t++)n[t].on(cc.Node.EventType.MOUSE_DOWN,this.clickTail,this);cc.game.on("clickBomb",function(t){e.isBombClicked=t,cc.game.emit("decrementBombs",1),cc.game.emit("lockOrUnlockBomb",!0)}),cc.game.on("clickMash",function(){e.mashTails()})},t.prototype.clickTail=function(e){var t=this;if(this.canClick){this.canClick=!1,this.scheduleOnce(function(){t.canClick=!0},this.clickThrottle),this.node.children.sort(function(e){return+e.name});var n=e.target;if(this.isBombClicked)return this.replaceWithBomb(n),void(this.isBombClicked=!1);var o,r,i=+n.name[0],c=+n.name[1],a=n.getComponent(cc.Sprite).spriteFrame.name;if("bomb"===a){var s=this.getCellsBombQd(i,c);r=s[0],o=s[1],cc.game.emit("lockOrUnlockBomb",!1)}else r=this.getSelectedCells(i,c,a,this.node.children);for(var l=[],h=0,u=r;h<u.length;h++){var p=u[h];l.push(p.name)}this.updateCellsPositions(l,o),r.length>1&&(cc.game.emit("incrementScore",5*r.length),cc.game.emit("decrementTurns",1)),this.checkLinesExists()||(this.invalidFieldMashes>0?(this.invalidFieldMashes--,this.mashTails()):cc.game.emit("CallLose"))}},t.prototype.checkLinesExists=function(){for(var e=0,t=this.node.children;e<t.length;e++){var n=t[e];if(this.checkNeighbourTails(n))return!0}return!1},t.prototype.checkNeighbourTails=function(e){var t=[],n=e.getComponent(cc.Sprite).spriteFrame.name,o=this.node.getChildByName(""+(+e.name[0]+1)+e.name[0]),r=this.node.getChildByName(""+(+e.name[0]-1)+e.name[0]),i=this.node.getChildByName(""+e.name[0]+(+e.name[0]+1)),c=this.node.getChildByName(""+e.name[0]+(+e.name[0]-1));t.push(o,r,i,c);for(var a=0,s=t;a<s.length;a++){var l=s[a];if(l&&l.getComponent(cc.Sprite).spriteFrame.name===n)return!0}return!1},t.prototype.getSelectedCells=function(e,t,n,o){var r=[o.find(function(n){return n.name===""+e+t})];return function e(t,n,o,i){if(n>=1){var c=n-1,a=i.find(function(e){return e.name===""+t+c}),s=r.includes(a);a.getComponent(cc.Sprite).spriteFrame.name!==o||s||(r.push(a),e(t,c,o,i))}if(n<=3){var l=n+1;a=i.find(function(e){return e.name===""+t+l}),s=r.includes(a),a.getComponent(cc.Sprite).spriteFrame.name!==o||s||(r.push(a),e(t,l,o,i))}if(t<=3){var h=t+1;a=i.find(function(e){return e.name===""+h+n}),s=r.includes(a),a.getComponent(cc.Sprite).spriteFrame.name!==o||s||(r.push(a),e(h,n,o,i))}if(t>=1){var u=t-1;a=i.find(function(e){return e.name===""+u+n}),s=r.includes(a),a.getComponent(cc.Sprite).spriteFrame.name!==o||s||(r.push(a),e(u,n,o,i))}}(e,t,n,o),r.sort(function(e){return e.name}),r},t.prototype.replaceWithBomb=function(e){e.getComponent(cc.Sprite).spriteFrame=this.abilitiesTailSpriteFrames[0]},t.prototype.mashTails=function(){for(var e=[],t=0,n=this.node.children;t<n.length;t++){var o=n[t],r=cc.instantiate(o);e.push(r)}var i=this.node.children.map(function(e){return e.name});e.sort(function(){return Math.random()-.5}),this.node.removeAllChildren(!1);for(var c=0,a=e;c<a.length;c++)(r=a[c]).name=i[e.indexOf(r)],this.node.addChild(r),r.setPosition(58*+r.name[0],58*+r.name[1]);for(var s=0,l=this.node.children;s<l.length;s++){var h=l[s];cc.instantiate(h),h.on(cc.Node.EventType.MOUSE_DOWN,this.clickTail,this)}cc.game.emit("decrementMash",1)},t.prototype.getCellsBombQd=function(e,t){for(var n=[],o=e+1>4?e:e+1,r=t-1<0?t:t-1,i=t+1>4?t:t+1,c=function(e){for(var t=function(t){var o=a.node.children.find(function(n){return n.name===""+e+t});n.push(o)},o=r;o<=i;o++)t(o)},a=this,s=e-1<0?e:e-1;s<=o;s++)c(s);return[n,"qd"]},t.prototype.updateCellsPositions=function(e,t){if(1!=e.length||t){for(var n=[],o=0,r=this.node.children;o<r.length;o++){var i=r[o];n.push(cc.instantiate(i))}for(var a=[],s=[],l=function(t){var n=e.sort().filter(function(e){return+e[0]===t});n.length>0&&a.push(n)},h=0;h<5;h++)l(h);for(var u=0,p=e;u<p.length;u++)i=p[u],s.push(i);for(var d=function(e){m.node.children.find(function(t){return t.name===e}).needDestroy=!0},m=this,f=0,y=s;f<y.length;f++)d(y[f]);for(var g=function(e){for(var t=c(e),n=+e[0][0],o=+e[0][1],r=5-+e[0][1],i=function(){for(var e=o+1,i=1;t.includes(""+n+e);)e++,i++;if(e>4){console.log("newRow>4");var c=new cc.Node(""+n+(e-i));C.node.addChild(c),c.setAnchorPoint(0,0),c.setPosition(58*n,58*e);var a=C.tailSpriteFrames[Math.floor(5*Math.random())];c.addComponent(cc.Sprite).spriteFrame=a,c.on(cc.Node.EventType.MOUSE_DOWN,C.clickTail,C),cc.tween(c).by(.3,{y:0-58*i},{easing:"sineIn"}).start()}else{var s=C.node.children.find(function(t){return t.name===""+n+e});cc.tween(s).by(.3,{y:0-58*i},{easing:"sineIn"}).start(),s.name=""+n+(e-i)}t.length<5&&t.push(""+n+e),o++,r--};r>0;)i()},C=this,v=0,b=a;v<b.length;v++)g(b[v]);for(var _=0,B=this.node.children;_<B.length;_++){var S=B[_];S.needDestroy&&S.destroy()}}},i([l({type:[cc.SpriteFrame]})],t.prototype,"tailSpriteFrames",void 0),i([l({type:[cc.SpriteFrame]})],t.prototype,"abilitiesTailSpriteFrames",void 0),i([l],t.prototype,"isBombClicked",void 0),i([l],t.prototype,"invalidFieldMashes",void 0),i([l],t.prototype,"canClick",void 0),i([l],t.prototype,"clickThrottle",void 0),i([s],t)}(cc.Component);n.default=h,cc._RF.pop()},{}]},{},["Boosters","Score","Tails"]);